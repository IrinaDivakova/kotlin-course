package org.example.`kotlin-course`.lessons.lesson21.homeworks

//Задача 1
//
//Напишите функцию analyzeDataType, принимающую параметр типа Any. Функция должна определить тип аргумента и вывести соответствующее сообщение:
// Для строки: "Это строка: [значение]".
////Для любого числа: "Это число: [значение]".
////Для списка: "Это список, количество элементов: [количество]".
////Для словаря: "Это словарь, количество пар: [количество]".
////Для остальных типов: "Неизвестный тип данных".
////Используйте оператор is для проверки типов.
fun analyzeDataType (data: Any?) {
    if (data != null) {
        when (data) {
            is String -> println("Это строка: $data.")
        is Number -> println("Это число: $data.")//Использовать класс-предок Number or (data is Int || data is Double || data is Float || ...)
         is List<*> -> println("Это список, количество элементов: ${data.size}")
         is Map<*,*> -> println("Это словарь, количество пар: ${data.size}")
            else -> println("Неизвестный тип данных")
        }
    }else{
        println("нет данных")
    }
}

//Задача 2
//
//Создайте функцию safeCastToList, принимающую параметр типа Any и возвращающую размер списка, если аргумент можно безопасно привести к типу List. В случае неудачного приведения функция должна возвращать -1. Используйте as? для безопасного приведения типа.
fun safeCastToList (data: Any): Int {
    val list = data as? List<*>

//    Проверяем результат приведения.
    if (list != null) {
        return list.size
    }
    else {
        return -1
    }
}
//Задача 3
//
//Создайте функцию getStringLengthOrZero, которая принимает параметр типа Any? и возвращает длину строки, если аргумент можно привести к типу String. В случае, если аргумент равен null или не является строкой, функция должна возвращать 0.
fun getStringLengthOrZero(data: Any?): Int {
    val str = data as? String
    if (str != null) {
        // Приведение успешно: возвращаем длину строки.
        // Здесь работает Smart Casts, и 'str' безопасно используется как String.
        return str.length
    } else {
        // Приведение не удалось ИЛИ исходное data было null.
        // В обоих случаях возвращаем 0.
        return 0
    }
}

//Задача 4
//
//Создайте функцию-расширение класса Any toSquare. Функция гарантированно вызывается у числа (в виде числа или строки, например 4 или 4.2 или “4.2”) и должна вернуть квадрат этого числа. Если придёт число, его нужно возвести в квадрат, если придёт строка, то его нужно преобразовать в число через функцию toDouble() и возвести в квадрат.
//
fun Any.toSquare(): Double {
    // 1. Используем when для проверки типа объекта (this)
    return when (this) {

        // СЛУЧАЙ 1: Если объект уже является числом (Int, Double, Float и т.д.)
        is Number -> {
            // Безопасно преобразуем его в Double и возводим в квадрат.
            val value = this.toDouble()
            value * value
        }

        // СЛУЧАЙ 2: Если объект является строкой
        is String -> {
            // Пытаемся преобразовать строку в Double.
            // Если преобразование неудачно, toDoubleOrNull() вернет null.
            val value = this.toDoubleOrNull()

            // Проверяем результат. Если value == null, выбрасываем ошибку.
            if (value != null) {
                value * value
            } else {
                // Если строка не содержит число (например, "hello"), выбрасываем исключение.
                throw IllegalArgumentException("Ошибка: Строка '$this' не является числом и не может быть возведена в квадрат.")
            }
        }

        // СЛУЧАЙ 3: Для всех остальных типов (Boolean, List, и т.д.)
        else -> {
            // Выбрасываем исключение, потому что функция не предназначена для этого типа.
            throw IllegalArgumentException("Ошибка: Неподдерживаемый тип ${this::class.simpleName}. Ожидается число или строка.")
        }
    }
}
//Задача 5
//
//Напишите функцию sumIntOrDoubleValues, которая принимает список элементов типа Any и возвращает сумму всех целочисленных (Int) и вещественных (Double) значений в списке. Все остальные типы должны быть проигнорированы.
fun sumIntOrDoubleValues (data: List<*>) : Double {
    var totalSum: Double = 0.0
    for (it in data) {
        when (it)
        { is Int -> totalSum += it.toDouble()
         is Double -> totalSum += it }
    }
    return totalSum
}
//
//Задача 6
//
//Создайте функцию tryCastToListAndPrint, которая принимает параметр типа Any и пытается привести его к типу List<*>. Если приведение успешно, функция должна напечатать все строки из списка, если элемент не является строкой то вывести предупреждение об этом. Если приведение неудачно, должно быть выведено сообщение об ошибке, не прерывая выполнение программы.
fun tryCastToListAndPrint(data: Any) {
    val list = data as? List<*>
    if (list != null) {
        for (it in list) {
        if (it is String) {
            println(it)
        }else{
            println("Предупреждение: $it не пренадлежит к типу Strings")
        }
    }
    }else {
    // --- Блок 2: Приведение неудачно (list == null) ---
    // Выводим сообщение об ошибке, не прерывая выполнение программы
    println("ОШИБКА: Входной аргумент не может быть безопасно приведен к типу List<*>.")
}
}
//